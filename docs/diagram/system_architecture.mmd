%% System Architecture with Authentication
flowchart TB
	%% Frontend Layer
	subgraph Browser[Browser Layer]
		direction TB
		Landing[landing.html]
		Login[login.html]
		Register[register.html]
		Chat[index.html]
		CSS[styles.css]
		JS[index.js]
		AuthJS[auth.js]
	end

	%% Backend Layer
	subgraph Flask[Flask Backend]
		direction TB
		
		subgraph Routes[Route Blueprints]
			PageRoutes[page_routes.py]
			ChatRoutes[chat_routes.py]
			AuthRoutes[auth_routes.py]
			AIRoutes[ai_routes.py]
		end
		
		subgraph Services[Service Layer]
			ChatService[Chat Service]
			AuthService[Auth Service]
			GeminiService[Gemini Service]
		end
		
		subgraph Middleware
			AuthMiddleware[JWT Auth Middleware]
			RateLimiter[Rate Limiter]
		end
	end

	%% Data Layer
	subgraph Storage[Data Storage]
		direction TB
		SQLite[(SQLite Database)]
		SessionStore[(Session Store)]
		Cache[(Cache - Optional)]
	end

	%% External Services
	subgraph External[External APIs]
		Gemini[(Google Gemini API)]
		Email[(Email Service - Optional)]
	end

	%% Connections - Frontend to Routes
	Landing --> PageRoutes
	Login --> AuthRoutes
	Register --> AuthRoutes
	Chat --> ChatRoutes
	JS --> ChatRoutes
	AuthJS --> AuthRoutes

	%% Routes to Services
	PageRoutes --> ChatService
	ChatRoutes --> ChatService
	AuthRoutes --> AuthService
	AIRoutes --> GeminiService

	%% Middleware
	ChatRoutes --> AuthMiddleware
	AIRoutes --> AuthMiddleware
	AuthMiddleware --> RateLimiter

	%% Services to Storage
	ChatService --> SQLite
	AuthService --> SQLite
	AuthService --> SessionStore
	ChatService --> Cache

	%% Services to External
	GeminiService --> Gemini
	AuthService --> Email

	%% Static Assets
	PageRoutes --> Landing
	PageRoutes --> Login
	PageRoutes --> Register
	PageRoutes --> Chat
	PageRoutes --> CSS
	PageRoutes --> JS
	PageRoutes --> AuthJS
